#!/usr/bin/env python
#This is a script to take input fastq data from FLASH and translate it with biopython
#Input data is in files like:
#/usr/share/sequencing/projects/317/alignments/317-D1-Bst3_S1_L001.relabel.fastq
#Then the translation needs to run from ATGGCACAG (MAQ) up to ACCGTCTCCTCA (TVSS)
#Note that most merged reads start as: CCGGCCATGGCACAG

#### NB THIS SCRIPT ONLY WORKS WITH FASTQ HEADER SHORT

import Bio
from Bio.Seq import Seq
import sys
import gzip
import re

filein = open(sys.argv[1])
fileout = open(sys.argv[2], "w")
notfound = open(str(sys.argv[2] + ".notfound"), "w")
log = open(str(sys.argv[2] + ".log"), "w")
nomultiplefile = open(str(sys.argv[2] + ".outframe"), "w")

# Regex pattern for matching sequences
startseq = r'(ATGGCTCAA|ATGGCTCAG|ATGGCCCAA|ATGGCCCAG|ATGGCACAA|ATGGCACAG|ATGGCGCAA|ATGGCGCAG|' \
    r'GTTCAATTA|GTTCAATTG|GTTCAACTT|GTTCAACTC|GTTCAACTA|GTTCAACTG|GTTCAGTTA|GTTCAGTTG|' \
    r'GTTCAGCTT|GTTCAGCTC|GTTCAGCTA|GTTCAGCTG|GTCCAATTA|GTCCAATTG|GTCCAACTT|GTCCAACTC|' \
    r'GTCCAACTA|GTCCAACTG|GTCCAGTTA|GTCCAGTTG|GTCCAGCTT|GTCCAGCTC|GTCCAGCTA|GTCCAGCTG|' \
    r'GTACAATTA|GTACAATTG|GTACAACTT|GTACAACTC|GTACAACTA|GTACAACTG|GTACAGTTA|GTACAGTTG|' \
    r'GTACAGCTT|GTACAGCTC|GTACAGCTA|GTACAGCTG|GTGCAATTA|GTGCAATTG|GTGCAACTT|GTGCAACTC|' \
    r'GTGCAACTA|GTGCAACTG|GTGCAGTTA|GTGCAGTTG|GTGCAGCTT|GTGCAGCTC|GTGCAGCTA|GTGCAGCTG|' \
    r'GAAGTTCAA|GAAGTTCAG|GAAGTCCAA|GAAGTCCAG|GAAGTACAA|GAAGTACAG|GAAGTGCAA|GAAGTGCAG|' \
    r'GAGGTTCAA|GAGGTTCAG|GAGGTCCAA|GAGGTCCAG|GAGGTACAA|GAGGTACAG|GAGGTGCAA|GAGGTGCAG|' \
    r'TTACAATTA|TTACAATTG|TTACAACTT|TTACAACTC|TTACAACTA|TTACAACTG|TTACAGTTA|TTACAGTTG|' \
    r'TTACAGCTT|TTACAGCTC|TTACAGCTA|TTACAGCTG|TTGCAATTA|TTGCAATTG|TTGCAACTT|TTGCAACTC|' \
    r'TTGCAACTA|TTGCAACTG|TTGCAGTTA|TTGCAGTTG|TTGCAGCTT|TTGCAGCTC|TTGCAGCTA|TTGCAGCTG|' \
    r'CTTCAATTA|CTTCAATTG|CTTCAACTT|CTTCAACTC|CTTCAACTA|CTTCAACTG|CTTCAGTTA|CTTCAGTTG|' \
    r'CTTCAGCTT|CTTCAGCTC|CTTCAGCTA|CTTCAGCTG|CTCCAATTA|CTCCAATTG|CTCCAACTT|CTCCAACTC|' \
    r'CTCCAACTA|CTCCAACTG|CTCCAGTTA|CTCCAGTTG|CTCCAGCTT|CTCCAGCTC|CTCCAGCTA|CTCCAGCTG|' \
    r'CTACAATTA|CTACAATTG|CTACAACTT|CTACAACTC|CTACAACTA|CTACAACTG|CTACAGTTA|CTACAGTTG|' \
    r'CTACAGCTT|CTACAGCTC|CTACAGCTA|CTACAGCTG|CTGCAATTA|CTGCAATTG|CTGCAACTT|CTGCAACTC|' \
    r'CTGCAACTA|CTGCAACTG|CTGCAGTTA|CTGCAGTTG|CTGCAGCTT|CTGCAGCTC|CTGCAGCTA|CTGCAGCTG|' \
    r'CAAGTTCAA|CAAGTTCAG|CAAGTCCAA|CAAGTCCAG|CAAGTACAA|CAAGTACAG|CAAGTGCAA|CAAGTGCAG|' \
    r'CAGGTTCAA|CAGGTTCAG|CAGGTCCAA|CAGGTCCAG|CAGGTACAA|CAGGTACAG|CAGGTGCAA|CAGGTGCAG)'

endseq = r'(ACTGTTTCTTCT|ACTGTTTCTTCC|ACTGTTTCTTCA|ACTGTTTCTTCG|ACTGTTTCTAGT|ACTGTTTCTAGC|ACTGTTTCCTCT|ACTGTTTCCTCC|' \
    r'ACTGTTTCCTCA|ACTGTTTCCTCG|ACTGTTTCCAGT|ACTGTTTCCAGC|ACTGTTTCATCT|ACTGTTTCATCC|ACTGTTTCATCA|ACTGTTTCATCG|' \
    r'ACTGTTTCAAGT|ACTGTTTCAAGC|ACTGTTTCGTCT|ACTGTTTCGTCC|ACTGTTTCGTCA|ACTGTTTCGTCG|ACTGTTTCGAGT|ACTGTTTCGAGC|' \
    r'ACTGTTAGTTCT|ACTGTTAGTTCC|ACTGTTAGTTCA|ACTGTTAGTTCG|ACTGTTAGTAGT|ACTGTTAGTAGC|ACTGTTAGCTCT|ACTGTTAGCTCC|' \
    r'CTGTTAGCTCA|ACTGTTAGCTCG|ACTGTTAGCAGT|ACTGTTAGCAGC|ACTGTCTCTTCT|ACTGTCTCTTCC|ACTGTCTCTTCA|ACTGTCTCTTCG|' \
    r'ACTGTCTCTAGT|ACTGTCTCTAGC|ACTGTCTCCTCT|ACTGTCTCCTCC|ACTGTCTCCTCA|ACTGTCTCCTCG|ACTGTCTCCAGT|ACTGTCTCCAGC|' \
    r'ACTGTCTCATCT|ACTGTCTCATCC|ACTGTCTCATCA|ACTGTCTCATCG|ACTGTCTCAAGT|ACTGTCTCAAGC|ACTGTCTCGTCT|ACTGTCTCGTCC|' \
    r'ACTGTCTCGTCA|ACTGTCTCGTCG|ACTGTCTCGAGT|ACTGTCTCGAGC|ACTGTCAGTTCT|ACTGTCAGTTCC|ACTGTCAGTTCA|ACTGTCAGTTCG|' \
    r'ACTGTCAGTAGT|ACTGTCAGTAGC|ACTGTCAGCTCT|ACTGTCAGCTCC|ACTGTCAGCTCA|ACTGTCAGCTCG|ACTGTCAGCAGT|ACTGTCAGCAGC|' \
    r'ACTGTATCTTCT|ACTGTATCTTCC|ACTGTATCTTCA|ACTGTATCTTCG|ACTGTATCTAGT|ACTGTATCTAGC|ACTGTATCCTCT|ACTGTATCCTCC|' \
    r'ACTGTATCCTCA|ACTGTATCCTCG|ACTGTATCCAGT|ACTGTATCCAGC|ACTGTATCATCT|ACTGTATCATCC|ACTGTATCATCA|ACTGTATCATCG|' \
    r'ACTGTATCAAGT|ACTGTATCAAGC|ACTGTATCGTCT|ACTGTATCGTCC|ACTGTATCGTCA|ACTGTATCGTCG|ACTGTATCGAGT|ACTGTATCGAGC|' \
    r'ACTGTAAGTTCT|ACTGTAAGTTCC|ACTGTAAGTTCA|ACTGTAAGTTCG|ACTGTAAGTAGT|ACTGTAAGTAGC|ACTGTAAGCTCT|ACTGTAAGCTCC|' \
    r'ACTGTAAGCTCA|ACTGTAAGCTCG|ACTGTAAGCAGT|ACTGTAAGCAGC|ACTGTGTCTTCT|ACTGTGTCTTCC|ACTGTGTCTTCA|ACTGTGTCTTCG|' \
    r'ACTGTGTCTAGT|ACTGTGTCTAGC|ACTGTGTCCTCT|ACTGTGTCCTCC|ACTGTGTCCTCA|ACTGTGTCCTCG|ACTGTGTCCAGT|ACTGTGTCCAGC|' \
    r'ACTGTGTCATCT|ACTGTGTCATCC|ACTGTGTCATCA|ACTGTGTCATCG|ACTGTGTCAAGT|ACTGTGTCAAGC|ACTGTGTCGTCT|ACTGTGTCGTCC|' \
    r'ACTGTGTCGTCA|ACTGTGTCGTCG|ACTGTGTCGAGT|ACTGTGTCGAGC|ACTGTGAGTTCT|ACTGTGAGTTCC|ACTGTGAGTTCA|ACTGTGAGTTCG|' \
    r'ACTGTGAGTAGT|ACTGTGAGTAGC|ACTGTGAGCTCT|ACTGTGAGCTCC|ACTGTGAGCTCA|ACTGTGAGCTCG|ACTGTGAGCAGT|ACTGTGAGCAGC|' \
    r'ACCGTTTCTTCT|ACCGTTTCTTCC|ACCGTTTCTTCA|ACCGTTTCTTCG|ACCGTTTCTAGT|ACCGTTTCTAGC|ACCGTTTCCTCT|ACCGTTTCCTCC|' \
    r'ACCGTTTCCTCA|ACCGTTTCCTCG|ACCGTTTCCAGT|ACCGTTTCCAGC|ACCGTTTCATCT|ACCGTTTCATCC|ACCGTTTCATCA|ACCGTTTCATCG|' \
    r'ACCGTTTCAAGT|ACCGTTTCAAGC|ACCGTTTCGTCT|ACCGTTTCGTCC|ACCGTTTCGTCA|ACCGTTTCGTCG|ACCGTTTCGAGT|ACCGTTTCGAGC|' \
    r'ACCGTTAGTTCT|ACCGTTAGTTCC|ACCGTTAGTTCA|ACCGTTAGTTCG|ACCGTTAGTAGT|ACCGTTAGTAGC|ACCGTTAGCTCT|ACCGTTAGCTCC|' \
    r'ACCGTTAGCTCA|ACCGTTAGCTCG|ACCGTTAGCAGT|ACCGTTAGCAGC|ACCGTCTCTTCT|ACCGTCTCTTCC|ACCGTCTCTTCA|ACCGTCTCTTCG|' \
    r'ACCGTCTCTAGT|ACCGTCTCTAGC|ACCGTCTCCTCT|ACCGTCTCCTCC|ACCGTCTCCTCA|ACCGTCTCCTCG|ACCGTCTCCAGT|ACCGTCTCCAGC|' \
    r'ACCGTCTCATCT|ACCGTCTCATCC|ACCGTCTCATCA|ACCGTCTCATCG|ACCGTCTCAAGT|ACCGTCTCAAGC|ACCGTCTCGTCT|ACCGTCTCGTCC|' \
    r'ACCGTCTCGTCA|ACCGTCTCGTCG|ACCGTCTCGAGT|ACCGTCTCGAGC|ACCGTCAGTTCT|ACCGTCAGTTCC|ACCGTCAGTTCA|ACCGTCAGTTCG|' \
    r'ACCGTCAGTAGT|ACCGTCAGTAGC|ACCGTCAGCTCT|ACCGTCAGCTCC|ACCGTCAGCTCA|ACCGTCAGCTCG|ACCGTCAGCAGT|ACCGTCAGCAGC|' \
    r'ACCGTATCTTCT|ACCGTATCTTCC|ACCGTATCTTCA|ACCGTATCTTCG|ACCGTATCTAGT|ACCGTATCTAGC|ACCGTATCCTCT|ACCGTATCCTCC|' \
    r'ACCGTATCCTCA|ACCGTATCCTCG|ACCGTATCCAGT|ACCGTATCCAGC|ACCGTATCATCT|ACCGTATCATCC|ACCGTATCATCA|ACCGTATCATCG|' \
    r'ACCGTATCAAGT|ACCGTATCAAGC|ACCGTATCGTCT|ACCGTATCGTCC|ACCGTATCGTCA|ACCGTATCGTCG|ACCGTATCGAGT|ACCGTATCGAGC|' \
    r'ACCGTAAGTTCT|ACCGTAAGTTCC|ACCGTAAGTTCA|ACCGTAAGTTCG|ACCGTAAGTAGT|ACCGTAAGTAGC|ACCGTAAGCTCT|ACCGTAAGCTCC|' \
    r'ACCGTAAGCTCA|ACCGTAAGCTCG|ACCGTAAGCAGT|ACCGTAAGCAGC|ACCGTGTCTTCT|ACCGTGTCTTCC|ACCGTGTCTTCA|ACCGTGTCTTCG|' \
    r'ACCGTGTCTAGT|ACCGTGTCTAGC|ACCGTGTCCTCT|ACCGTGTCCTCC|ACCGTGTCCTCA|ACCGTGTCCTCG|ACCGTGTCCAGT|ACCGTGTCCAGC|' \
    r'ACCGTGTCATCT|ACCGTGTCATCC|ACCGTGTCATCA|ACCGTGTCATCG|ACCGTGTCAAGT|ACCGTGTCAAGC|ACCGTGTCGTCT|ACCGTGTCGTCC|' \
    r'ACCGTGTCGTCA|ACCGTGTCGTCG|ACCGTGTCGAGT|ACCGTGTCGAGC|ACCGTGAGTTCT|ACCGTGAGTTCC|ACCGTGAGTTCA|ACCGTGAGTTCG|' \
    r'ACCGTGAGTAGT|ACCGTGAGTAGC|ACCGTGAGCTCT|ACCGTGAGCTCC|ACCGTGAGCTCA|ACCGTGAGCTCG|ACCGTGAGCAGT|ACCGTGAGCAGC|' \
    r'ACAGTTTCTTCT|ACAGTTTCTTCC|ACAGTTTCTTCA|ACAGTTTCTTCG|ACAGTTTCTAGT|ACAGTTTCTAGC|ACAGTTTCCTCT|ACAGTTTCCTCC|' \
    r'ACAGTTTCCTCA|ACAGTTTCCTCG|ACAGTTTCCAGT|ACAGTTTCCAGC|ACAGTTTCATCT|ACAGTTTCATCC|ACAGTTTCATCA|ACAGTTTCATCG|' \
    r'ACAGTTTCAAGT|ACAGTTTCAAGC|ACAGTTTCGTCT|ACAGTTTCGTCC|ACAGTTTCGTCA|ACAGTTTCGTCG|ACAGTTTCGAGT|ACAGTTTCGAGC|' \
    r'ACAGTTAGTTCT|ACAGTTAGTTCC|ACAGTTAGTTCA|ACAGTTAGTTCG|ACAGTTAGTAGT|ACAGTTAGTAGC|ACAGTTAGCTCT|ACAGTTAGCTCC|' \
    r'ACAGTTAGCTCA|ACAGTTAGCTCG|ACAGTTAGCAGT|ACAGTTAGCAGC|ACAGTCTCTTCT|ACAGTCTCTTCC|ACAGTCTCTTCA|ACAGTCTCTTCG|' \
    r'ACAGTCTCTAGT|ACAGTCTCTAGC|ACAGTCTCCTCT|ACAGTCTCCTCC|ACAGTCTCCTCA|ACAGTCTCCTCG|ACAGTCTCCAGT|ACAGTCTCCAGC|' \
    r'ACAGTCTCATCT|ACAGTCTCATCC|ACAGTCTCATCA|ACAGTCTCATCG|ACAGTCTCAAGT|ACAGTCTCAAGC|ACAGTCTCGTCT|ACAGTCTCGTCC|' \
    r'ACAGTCTCGTCA|ACAGTCTCGTCG|ACAGTCTCGAGT|ACAGTCTCGAGC|ACAGTCAGTTCT|ACAGTCAGTTCC|ACAGTCAGTTCA|ACAGTCAGTTCG|' \
    r'ACAGTCAGTAGT|ACAGTCAGTAGC|ACAGTCAGCTCT|ACAGTCAGCTCC|ACAGTCAGCTCA|ACAGTCAGCTCG|ACAGTCAGCAGT|ACAGTCAGCAGC|' \
    r'ACAGTATCTTCT|ACAGTATCTTCC|ACAGTATCTTCA|ACAGTATCTTCG|ACAGTATCTAGT|ACAGTATCTAGC|ACAGTATCCTCT|ACAGTATCCTCC|' \
    r'ACAGTATCCTCA|ACAGTATCCTCG|ACAGTATCCAGT|ACAGTATCCAGC|ACAGTATCATCT|ACAGTATCATCC|ACAGTATCATCA|ACAGTATCATCG|' \
    r'ACAGTATCAAGT|ACAGTATCAAGC|ACAGTATCGTCT|ACAGTATCGTCC|ACAGTATCGTCA|ACAGTATCGTCG|ACAGTATCGAGT|ACAGTATCGAGC|' \
    r'ACAGTAAGTTCT|ACAGTAAGTTCC|ACAGTAAGTTCA|ACAGTAAGTTCG|ACAGTAAGTAGT|ACAGTAAGTAGC|ACAGTAAGCTCT|ACAGTAAGCTCC|' \
    r'ACAGTAAGCTCA|ACAGTAAGCTCG|ACAGTAAGCAGT|ACAGTAAGCAGC|ACAGTGTCTTCT|ACAGTGTCTTCC|ACAGTGTCTTCA|ACAGTGTCTTCG|' \
    r'ACAGTGTCTAGT|ACAGTGTCTAGC|ACAGTGTCCTCT|ACAGTGTCCTCC|ACAGTGTCCTCA|ACAGTGTCCTCG|ACAGTGTCCAGT|ACAGTGTCCAGC|' \
    r'ACAGTGTCATCT|ACAGTGTCATCC|ACAGTGTCATCA|ACAGTGTCATCG|ACAGTGTCAAGT|ACAGTGTCAAGC|ACAGTGTCGTCT|ACAGTGTCGTCC|' \
    r'ACAGTGTCGTCA|ACAGTGTCGTCG|ACAGTGTCGAGT|ACAGTGTCGAGC|ACAGTGAGTTCT|ACAGTGAGTTCC|ACAGTGAGTTCA|ACAGTGAGTTCG|' \
    r'ACAGTGAGTAGT|ACAGTGAGTAGC|ACAGTGAGCTCT|ACAGTGAGCTCC|ACAGTGAGCTCA|ACAGTGAGCTCG|ACAGTGAGCAGT|ACAGTGAGCAGC|' \
    r'ACGGTTTCTTCT|ACGGTTTCTTCC|ACGGTTTCTTCA|ACGGTTTCTTCG|ACGGTTTCTAGT|ACGGTTTCTAGC|ACGGTTTCCTCT|ACGGTTTCCTCC|' \
    r'ACGGTTTCCTCA|ACGGTTTCCTCG|ACGGTTTCCAGT|ACGGTTTCCAGC|ACGGTTTCATCT|ACGGTTTCATCC|ACGGTTTCATCA|ACGGTTTCATCG|' \
    r'ACGGTTTCAAGT|ACGGTTTCAAGC|ACGGTTTCGTCT|ACGGTTTCGTCC|ACGGTTTCGTCA|ACGGTTTCGTCG|ACGGTTTCGAGT|ACGGTTTCGAGC|' \
    r'ACGGTTAGTTCT|ACGGTTAGTTCC|ACGGTTAGTTCA|ACGGTTAGTTCG|ACGGTTAGTAGT|ACGGTTAGTAGC|ACGGTTAGCTCT|ACGGTTAGCTCC|' \
    r'ACGGTTAGCTCA|ACGGTTAGCTCG|ACGGTTAGCAGT|ACGGTTAGCAGC|ACGGTCTCTTCT|ACGGTCTCTTCC|ACGGTCTCTTCA|ACGGTCTCTTCG|' \
    r'ACGGTCTCTAGT|ACGGTCTCTAGC|ACGGTCTCCTCT|ACGGTCTCCTCC|ACGGTCTCCTCA|ACGGTCTCCTCG|ACGGTCTCCAGT|ACGGTCTCCAGC|' \
    r'ACGGTCTCATCT|ACGGTCTCATCC|ACGGTCTCATCA|ACGGTCTCATCG|ACGGTCTCAAGT|ACGGTCTCAAGC|ACGGTCTCGTCT|ACGGTCTCGTCC|' \
    r'ACGGTCTCGTCA|ACGGTCTCGTCG|ACGGTCTCGAGT|ACGGTCTCGAGC|ACGGTCAGTTCT|ACGGTCAGTTCC|ACGGTCAGTTCA|ACGGTCAGTTCG|' \
    r'ACGGTCAGTAGT|ACGGTCAGTAGC|ACGGTCAGCTCT|ACGGTCAGCTCC|ACGGTCAGCTCA|ACGGTCAGCTCG|ACGGTCAGCAGT|ACGGTCAGCAGC|' \
    r'ACGGTATCTTCT|ACGGTATCTTCC|ACGGTATCTTCA|ACGGTATCTTCG|ACGGTATCTAGT|ACGGTATCTAGC|ACGGTATCCTCT|ACGGTATCCTCC|' \
    r'ACGGTATCCTCA|ACGGTATCCTCG|ACGGTATCCAGT|ACGGTATCCAGC|ACGGTATCATCT|ACGGTATCATCC|ACGGTATCATCA|ACGGTATCATCG|' \
    r'ACGGTATCAAGT|ACGGTATCAAGC|ACGGTATCGTCT|ACGGTATCGTCC|ACGGTATCGTCA|ACGGTATCGTCG|ACGGTATCGAGT|ACGGTATCGAGC|' \
    r'ACGGTAAGTTCT|ACGGTAAGTTCC|ACGGTAAGTTCA|ACGGTAAGTTCG|ACGGTAAGTAGT|ACGGTAAGTAGC|ACGGTAAGCTCT|ACGGTAAGCTCC|' \
    r'ACGGTAAGCTCA|ACGGTAAGCTCG|ACGGTAAGCAGT|ACGGTAAGCAGC|ACGGTGTCTTCT|ACGGTGTCTTCC|ACGGTGTCTTCA|ACGGTGTCTTCG|' \
    r'ACGGTGTCTAGT|ACGGTGTCTAGC|ACGGTGTCCTCT|ACGGTGTCCTCC|ACGGTGTCCTCA|ACGGTGTCCTCG|ACGGTGTCCAGT|ACGGTGTCCAGC|' \
    r'ACGGTGTCATCT|ACGGTGTCATCC|ACGGTGTCATCA|ACGGTGTCATCG|ACGGTGTCAAGT|ACGGTGTCAAGC|ACGGTGTCGTCT|ACGGTGTCGTCC|' \
    r'ACGGTGTCGTCA|ACGGTGTCGTCG|ACGGTGTCGAGT|ACGGTGTCGAGC|ACGGTGAGTTCT|ACGGTGAGTTCC|ACGGTGAGTTCA|ACGGTGAGTTCG|' \
    r'ACGGTGAGTAGT|ACGGTGAGTAGC|ACGGTGAGCTCT|ACGGTGAGCTCC|ACGGTGAGCTCA|ACGGTGAGCTCG|ACGGTGAGCAGT|ACGGTGAGCAGC)'

readsread = 0
readspassing = 0
foundstart = 0
foundend = 0
notinframe = 0
withstop = 0
nostartnoend = 0

linecounter = 0
for line in filein:
    linecounter += 1
    if linecounter % 4 == 1:
        readsread += 1
        headerline = line
    if linecounter % 4 == 2:
        dna = Seq(line.rstrip())

        # Find start sequence
        if len(re.findall(startseq, str(dna))) > 0:
            startbase = dna.find(re.findall(startseq, str(dna))[0])
            foundstart += 1
        else:
            startbase = -1

        # Find end sequence with check to avoid IndexError
        if len(re.findall(endseq, str(dna))) > 0:
            endbase = dna.find(re.findall(endseq, str(dna))[0])  # Find the first matching sequence
            foundend += 1
        else:
            endbase = -1

        if startbase == -1 or endbase == -1:  # Read fails if missing the start or end sequence
            nostartnoend += 1
            notfound.write("sequenza non trovata" + "\t" + str(dna) + "\n")
            continue

        targetregion = dna[startbase:endbase + 12] # 12 is the length of the codon correspondence to TVSS of which endbase captures only the start
        if len(str(targetregion)) % 3 != 0:  # Read fails if the grabbed region is not a multiple of three
            notinframe += 1
            nomultiplefile.write(headerline + "\t" + str(dna) + "\t" + str(startbase) + "\t" + str(endbase) + "\t" + str(targetregion) + "\n")
            continue

        translated = targetregion.translate()
        if "*" in str(translated):  # Read fails if it has a stop codon
            withstop += 1
            continue

        readspassing += 1
        fileout.write(headerline)
        fileout.write(str(translated) + "\n")

log.write("Completed reading reads:")
log.write(readsread)
log.write("Of which passing and written into FASTA:")
log.write(readspassing)
log.write("start matched are")
log.write(foundstart)
log.write("end matched are")
log.write(foundend)
log.write("failed because missing start or missing end")
log.write(nostartnoend)
log.write("failed because not in frame, i.e. not multiple of 3")
log.write(notinframe)
log.write("failed because there is a stop codon in the sequence")
log.write(withstop)
